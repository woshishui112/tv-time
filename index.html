<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…çº§ç”µè§†æ—¶é—´èµšå–å™¨ Pro (å›°éš¾ç‰ˆ)</title>
    <style>
        :root { 
            --primary: #34495e; 
            --wolf: #9b59b6; 
            --fact: #2980b9; 
            --logic: #d35400; 
            --bg: #f5f7fa; 
            --card: #ffffff; 
            --green: #27ae60;
            --red: #c0392b;
            --orange: #f39c12;
        }
        body { font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; background: var(--bg); color: #2c3e50; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        /* é¡¶éƒ¨çœ‹æ¿ */
        header { 
            text-align: center; 
            width: 100%; 
            max-width: 600px;
            margin-bottom: 20px; 
            background: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .title-area h1 { margin: 0; font-size: 1.4rem; }
        .title-area p { margin: 5px 0 0; opacity: 0.8; font-size: 0.9rem; }
        
        .score-box { text-align: right; }
        .score-num { font-size: 2.2rem; font-weight: bold; color: var(--orange); line-height: 1; }
        .score-label { font-size: 0.8rem; opacity: 0.8; }

        /* å¯¼èˆª */
        nav { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        .nav-btn { 
            padding: 10px 12px; 
            border: none; 
            background: white; 
            border-radius: 10px; 
            cursor: pointer; 
            font-weight: bold; 
            color: #95a5a6; 
            font-size: 0.9rem;
            transition: 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .nav-btn.active { color: white; transform: translateY(2px); box-shadow: none; }
        
        .nav-btn[data-tab="fact"].active { background: var(--fact); }
        .nav-btn[data-tab="wolf"].active { background: var(--wolf); }
        .nav-btn[data-tab="logic"].active { background: var(--logic); }
        
        .nav-btn.finished { opacity: 0.6; background: #bdc3c7; color: #fff; text-decoration: line-through; }

        /* ä¸»å¡ç‰‡ */
        main { width: 100%; max-width: 600px; position: relative; }
        .card { background: var(--card); padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); display: none; animation: slideUp 0.3s; }
        .card.active { display: block; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* è¿›åº¦æ¡ */
        .progress-bar-bg { background: #ecf0f1; height: 10px; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: var(--green); width: 0%; transition: width 0.3s; }
        .progress-text { text-align: right; font-size: 0.8rem; color: #7f8c8d; margin-bottom: 5px; font-weight: bold; }

        /* é¢˜ç›® */
        .q-text { font-size: 1.25rem; font-weight: 700; line-height: 1.5; margin-bottom: 25px; min-height: 60px; color: #2c3e50; }
        
        /* æŒ‰é’®é€šç”¨ */
        .options-grid { display: grid; gap: 12px; }
        .btn-opt { 
            padding: 15px; 
            border: 2px solid #ecf0f1; 
            background: white; 
            border-radius: 12px; 
            cursor: pointer; 
            font-size: 1.05rem; 
            text-align: left; 
            transition: 0.2s; 
            font-weight: 600;
            color: #576574;
        }
        .btn-opt:hover { border-color: var(--primary); background: #f8f9fa; }
        
        /* äº‹å®è§‚ç‚¹å¤§æŒ‰é’® */
        .fact-btns { display: flex; gap: 15px; }
        .fact-btns button { flex: 1; padding: 20px; font-size: 1.1rem; border: none; border-radius: 15px; cursor: pointer; color: white; font-weight: bold; transition: transform 0.1s; }
        .fact-btns button:active { transform: scale(0.98); }
        .btn-f { background: var(--fact); box-shadow: 0 4px 0 #1f6391; }
        .btn-o { background: #e67e22; box-shadow: 0 4px 0 #ca6f1e; }

        /* åé¦ˆåŒº */
        .feedback-box { margin-top: 25px; padding: 15px; border-radius: 12px; display: none; text-align: center; }
        .feedback-box.correct { background: #e8f8f5; border: 2px solid #a2d9ce; color: #16a085; }
        .feedback-box.wrong { background: #fdedec; border: 2px solid #fadbd8; color: #c0392b; }
        .explain-text { font-size: 0.95rem; margin-top: 8px; text-align: left; background: rgba(255,255,255,0.7); padding: 8px; border-radius: 8px; }

        .next-btn { 
            margin-top: 20px; width: 100%; padding: 15px; 
            background: var(--primary); color: white; 
            border: none; border-radius: 12px; 
            cursor: pointer; font-size: 1.1rem; font-weight: bold;
            display: none; box-shadow: 0 4px 0 #1a252f;
        }
        .next-btn:active { transform: translateY(4px); box-shadow: none; }

        /* å…‘æ¢åˆ¸ */
        .coupon {
            background: #fff;
            border: 4px dashed var(--orange);
            text-align: center;
            padding: 30px;
        }
        .coupon-val { font-size: 4rem; font-weight: bold; color: var(--orange); margin: 10px 0; }
        .coupon-note { font-size: 1.1rem; color: #7f8c8d; margin-top: 10px; }
        .bonus-tag { 
            background: var(--red); color: white; padding: 5px 15px; 
            border-radius: 20px; font-size: 0.9rem; display: inline-block; 
            margin-bottom: 10px; font-weight: bold;
        }
    </style>
</head>
<body>

<header>
    <div class="title-area">
        <h1>ğŸ§  è„‘åŠ›é£æš´èµšå–å™¨ Pro</h1>
        <p>ä»Šæ—¥æŒ‘æˆ˜ï¼šéšæœº50é¢˜ (éš¾åº¦UP)</p>
    </div>
    <div class="score-box">
        <div class="score-label">å½“å‰å¾—åˆ†</div>
        <div><span class="score-num" id="global-score">0</span> <span style="font-size:1rem">åˆ†</span></div>
    </div>
</header>

<nav>
    <button class="nav-btn active" id="nav-fact" data-tab="fact" onclick="switchTab('fact')">1. äº‹å®é‰´åˆ« (15é¢˜)</button>
    <button class="nav-btn" id="nav-wolf" data-tab="wolf" onclick="switchTab('wolf')">2. é€»è¾‘ç‹¼äºº (20é¢˜)</button>
    <button class="nav-btn" id="nav-logic" data-tab="logic" onclick="switchTab('logic')">3. æ·±åº¦æ¨ç† (15é¢˜)</button>
</nav>

<main>
    <!-- æ¸¸æˆä¸»ç•Œé¢ -->
    <div id="game-card" class="card active">
        <div class="progress-text" id="progress-text">å‡†å¤‡å¼€å§‹...</div>
        <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="progress-bar"></div>
        </div>

        <div id="question-area">
            <div class="q-text" id="q-text">é¢˜ç›®åŠ è½½ä¸­...</div>
            
            <!-- Fact Buttons -->
            <div class="fact-btns" id="fact-btns" style="display:none;">
                <button class="btn-f" onclick="checkAnswer('fact')">ğŸ“˜ äº‹å® (Fact)</button>
                <button class="btn-o" onclick="checkAnswer('opinion')">ğŸ“™ è§‚ç‚¹ (Opinion)</button>
            </div>

            <!-- Generic Options Buttons -->
            <div class="options-grid" id="opt-btns" style="display:none;"></div>
        </div>

        <div id="feedback" class="feedback-box"></div>
        <button class="next-btn" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â¡ï¸</button>
    </div>

    <!-- å…³å¡å®Œæˆç•Œé¢ -->
    <div id="done-card" class="card" style="text-align:center; padding:50px 20px;">
        <h2 style="color:var(--green); font-size:2rem;">ğŸ‰ æœ¬å…³å®Œæˆï¼</h2>
        <p style="font-size:1.2rem; color:#7f8c8d;">è¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼Œåˆ‡æ¢ä¸‹ä¸€ä¸ªæŒ‘æˆ˜ã€‚</p>
    </div>

    <!-- æœ€ç»ˆå…‘æ¢åˆ¸ -->
    <div id="coupon-card" class="card coupon">
        <div id="bonus-msg" class="bonus-tag" style="display:none;">ğŸ‰ è§¦å‘è¶…çº§å¥–åŠ±ï¼</div>
        <h2 style="color:#2c3e50; margin:0;">âœ¨ ç”µè§†æ—¶é—´å…‘æ¢åˆ¸ âœ¨</h2>
        <div class="coupon-val"><span id="final-minutes">0</span> åˆ†é’Ÿ</div>
        <div class="coupon-note">
            åŸå§‹å¾—åˆ†: <span id="raw-score">0</span>/50<br>
            <span id="reward-explain" style="font-size:0.9rem"></span>
        </div>
        <p style="margin-top:30px; font-size:0.9rem; color:#bdc3c7;">æŒ‘æˆ˜å·²ç»“æŸï¼Œæ˜å¤©å†æ¥ï¼</p>
    </div>
</main>

<script>
    // ==========================================
    // â¬‡ï¸ å¤§å‹é¢˜åº“åŒº (Master Pools)
    // ==========================================

    // 1. äº‹å® vs è§‚ç‚¹ (éš¾åº¦å‡çº§ç‰ˆ)
    // äº‹å®ï¼šå¯ä»¥è¢«è¯æ˜çœŸå‡çš„é™ˆè¿°ï¼ˆå®¢è§‚ï¼‰ã€‚
    // è§‚ç‚¹ï¼šè¡¨è¾¾ä¿¡å¿µã€æ„Ÿè§‰æˆ–ä»·å€¼è§‚çš„é™ˆè¿°ï¼ˆä¸»è§‚ï¼‰ã€‚
    const masterFactDB = [
        { text: "æ°´åœ¨æ ‡å‡†å¤§æ°”å‹ä¸‹100æ‘„æ°åº¦æ²¸è…¾ã€‚", type: "fact", explain: "è¿™æ˜¯ç§‘å­¦å®šå¾‹ï¼Œå¯è¢«éªŒè¯ã€‚" },
        { text: "æ¢µé«˜çš„ã€Šæ˜Ÿç©ºã€‹æ˜¯ä¸–ç•Œä¸Šæœ€ç¾ä¸½çš„ç”»ä½œã€‚", type: "opinion", explain: "â€œæœ€ç¾ä¸½â€æ˜¯ä¸»è§‚è¯„ä»·ï¼Œæ¯ä¸ªäººå®¡ç¾ä¸åŒã€‚" },
        { text: "è™è æ˜¯å”¯ä¸€ä¼šé£çš„å“ºä¹³åŠ¨ç‰©ã€‚", type: "fact", explain: "è¿™æ˜¯ç”Ÿç‰©å­¦äº‹å®ã€‚" },
        { text: "é˜…è¯»æ¯”çœ‹ç”µè§†æ›´æœ‰è¶£ã€‚", type: "opinion", explain: "è¿™æ˜¯ä¸ªäººå–œå¥½ã€‚" },
        { text: "åœ°çƒç»•ç€å¤ªé˜³è½¬ï¼Œè½¬ä¸€åœˆå¤§çº¦éœ€è¦365å¤©ã€‚", type: "fact", explain: "è¿™æ˜¯å¤©æ–‡å­¦äº‹å®ã€‚" },
        { text: "æœ€å¥½çš„è§£å†³å†²çªçš„æ–¹æ³•æ˜¯é“æ­‰ã€‚", type: "opinion", explain: "æœ‰æ—¶å€™æ²Ÿé€šæˆ–æ³•å¾‹é€”å¾„æ›´å¥½ï¼Œè¿™å–å†³äºå…·ä½“æƒ…å†µã€‚" },
        { text: "è¥¿çº¢æŸ¿åœ¨æ¤ç‰©å­¦ä¸Šå±äºæ°´æœï¼ˆæµ†æœï¼‰ã€‚", type: "fact", explain: "è™½ç„¶æˆ‘ä»¬å¸¸å½“è”¬èœåƒï¼Œä½†åœ¨æ¤ç‰©å­¦å®šä¹‰ä¸Šå®ƒæ˜¯æœå®ã€‚" },
        { text: "æ•°å­¦æ˜¯æ‰€æœ‰å­¦ç§‘ä¸­æœ€éš¾çš„ã€‚", type: "opinion", explain: "å¯¹æŸäº›äººæ¥è¯´è¯­æ–‡å¯èƒ½æ›´éš¾ã€‚" },
        { text: "äººç±»éœ€è¦æ°§æ°”æ‰èƒ½ç”Ÿå­˜ã€‚", type: "fact", explain: "ç”Ÿç†å­¦å¸¸è¯†ã€‚" },
        { text: "èœ˜è››æœ‰8æ¡è…¿ã€‚", type: "fact", explain: "æ˜†è™«6æ¡è…¿ï¼Œèœ˜è››æ˜¯è››å½¢çº²ï¼Œæœ‰8æ¡ã€‚" },
        { text: "å†¬å¤©æ˜¯ä¸€å¹´ä¸­æœ€ç³Ÿç³•çš„å­£èŠ‚ã€‚", type: "opinion", explain: "æ»‘é›ªçˆ±å¥½è€…å¯èƒ½æœ€å–œæ¬¢å†¬å¤©ã€‚" },
        { text: "é•¿åŸä½äºä¸­å›½ã€‚", type: "fact", explain: "åœ°ç†äº‹å®ã€‚" },
        { text: "ç”µå­æ¸¸æˆæµªè´¹æ—¶é—´ã€‚", type: "opinion", explain: "è¿™ä¹Ÿæ˜¯ä¸€ç§å¨±ä¹æˆ–èŒä¸šï¼Œå–å†³äºæ€ä¹ˆçœ‹ã€‚" },
        { text: "å…‰é€Ÿæ¯”å£°é€Ÿå¿«ã€‚", type: "fact", explain: "è¿™æ˜¯æ‰“é›·æ—¶å…ˆçœ‹åˆ°é—ªç”µåå¬åˆ°é›·å£°çš„åŸå› ã€‚" },
        { text: "å¦‚æœä½ ä¸åƒæ—©é¤ï¼Œä½ ä¸Šåˆä¼šæ„Ÿåˆ°é¥¿ã€‚", type: "fact", explain: "è¿™æ˜¯èº«ä½“çš„ç”Ÿç†ååº”ï¼ˆé€šå¸¸æƒ…å†µï¼‰ã€‚" },
        { text: "åº”è¯¥ç¦æ­¢æ‰€æœ‰å­¦æ ¡å¸ƒç½®ä½œä¸šã€‚", type: "opinion", explain: "è¿™æ˜¯å…³äºæ”¿ç­–çš„çœ‹æ³•ï¼Œå¹¶éå®¢è§‚äº‹å®ã€‚" },
        { text: "ä¼é¹…ç”Ÿæ´»åœ¨å—åŠçƒã€‚", type: "fact", explain: "å¤§éƒ¨åˆ†ä¼é¹…åœ¨å—æï¼ŒåŒ—ææ²¡æœ‰ä¼é¹…ã€‚" },
        { text: "è“è‰²è®©äººæ„Ÿåˆ°æ‚²ä¼¤ã€‚", type: "opinion", explain: "é¢œè‰²å¿ƒç†å­¦å› äººè€Œå¼‚ï¼Œè“è‰²ä¹Ÿä»£è¡¨å¹³é™ã€‚" },
        { text: "ç‹—æ˜¯äººç±»æœ€å¥½çš„æœ‹å‹ã€‚", type: "opinion", explain: "è™½ç„¶å¸¸è¿™ä¹ˆè¯´ï¼Œä½†è¿™æ˜¯ä¸€ç§æƒ…æ„Ÿè¡¨è¾¾ï¼ŒçŒ«æ´¾å¯èƒ½ä¸åŒæ„ã€‚" },
        { text: "ä¸‰è§’å½¢çš„å†…è§’å’Œæ˜¯180åº¦ã€‚", type: "fact", explain: "å‡ ä½•å­¦å®šç†ã€‚" },
        { text: "è‰è“æ¯”é¦™è•‰å«æœ‰æ›´å¤šçš„ç»´ç”Ÿç´ Cã€‚", type: "fact", explain: "ç»ç§‘å­¦æµ‹å®šï¼Œè‰è“ç»´Cå«é‡ç¡®å®æ›´é«˜ã€‚" },
        { text: "ç†¬å¤œå¯¹èº«ä½“å¥åº·æœ‰å®³ã€‚", type: "fact", explain: "åŒ»å­¦ç ”ç©¶è¯æ˜çš„äº‹å®ã€‚" },
        { text: "è¿™é“é¢˜ç›®å¾ˆéš¾ã€‚", type: "opinion", explain: "éš¾æ˜“ç¨‹åº¦å–å†³äºåšé¢˜äººçš„æ°´å¹³ã€‚" },
        { text: "å·´é»æ˜¯æ³•å›½çš„é¦–éƒ½ã€‚", type: "fact", explain: "åœ°ç†äº‹å®ã€‚" },
        { text: "æ‹¥æœ‰å¾ˆå¤šé’±æ˜¯å¹¸ç¦çš„å…³é”®ã€‚", type: "opinion", explain: "å¹¸ç¦çš„å®šä¹‰å› äººè€Œå¼‚ã€‚" }
    ];

    // 2. ç‹¼äººæ€/é€»è¾‘é™·é˜± (éš¾åº¦å‡çº§ç‰ˆ)
    // è§„åˆ™ï¼šç‹¼äºº(Liars)æ°¸è¿œè¯´è°ï¼Œå¥½äºº(Truthtellers)æ°¸è¿œè¯´çœŸè¯ã€‚
    const masterWolfDB = [
        { text: "Aè¯´ï¼š'å¤ªé˜³ç»•ç€åœ°çƒè½¬'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "è¿™æ˜¯é”™è¯¯çš„å¸¸è¯†ï¼ˆåœ°å¿ƒè¯´å·²åºŸé™¤ï¼‰ï¼Œæ‰€ä»¥ä»–åœ¨æ’’è°ã€‚" },
        { text: "Aè¯´ï¼š'é²¸é±¼æ˜¯ç”¨è‚ºå‘¼å¸çš„'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "è¿™æ˜¯çœŸè¯ï¼Œé²¸é±¼æ˜¯å“ºä¹³åŠ¨ç‰©ã€‚" },
        { text: "Aè¯´ï¼š'å¦‚æœä½ æŠŠåœ†åˆ†æˆä¸¤åŠï¼Œå®ƒå°±å˜æˆäº†ä¸¤ä¸ªä¸‰è§’å½¢'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "åœ†åˆ‡å¼€æ˜¯ä¸¤ä¸ªåŠåœ†ï¼ŒAåœ¨èƒ¡è¯´ã€‚" },
        { text: "Aè¯´ï¼š'æœ‰äº›é¸Ÿä¸ä¼šé£'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "çœŸè¯ï¼Œæ¯”å¦‚ä¼é¹…å’Œé¸µé¸Ÿã€‚" },
        { text: "Aè¯´ï¼š'æ˜¨å¤©æ˜¯æ˜ŸæœŸäº”ï¼Œæ˜å¤©å°±æ˜¯æ˜ŸæœŸæ—¥'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "æ˜¨å¤©å‘¨äº”->ä»Šå¤©å‘¨å…­->æ˜å¤©å‘¨æ—¥ã€‚é€»è¾‘æ­£ç¡®ã€‚" },
        { text: "Aè¯´ï¼š'æ‰€æœ‰çš„å¥‡æ•°éƒ½èƒ½è¢«2æ•´é™¤'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "è¿™æ˜¯å¶æ•°çš„å®šä¹‰ï¼ŒAåœ¨æ’’è°ã€‚" },
        { text: "Aè¯´ï¼š'æˆ‘æ­£åœ¨è¯´è°'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº", "æ‚–è®º"], correct: 2, explain: "å¦‚æœä»–æ˜¯å¥½äººï¼Œä¸èƒ½è¯´è°ï¼›å¦‚æœä»–æ˜¯ç‹¼äººï¼Œè¿™å¥è¯å°±æ˜¯çœŸè¯ï¼ˆç‹¼äººä¸èƒ½è¯´çœŸè¯ï¼‰ã€‚è¿™æ˜¯è‘—åçš„è¯´è°è€…æ‚–è®ºã€‚" },
        { text: "Aè¯´ï¼š'å†°æ¯”æ°´é‡ï¼Œæ‰€ä»¥å†°ä¼šæ²‰åœ¨æ°´åº•'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "å†°æ¯”æ°´è½»ï¼ˆå¯†åº¦å°ï¼‰ï¼Œä¼šæµ®åœ¨æ°´é¢ã€‚Aæ˜¯ç‹¼äººã€‚" },
        { text: "Aè¯´ï¼š'ä¸€å¹´æœ‰365å¤©æˆ–366å¤©'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "çœŸè¯ï¼Œå¹³å¹´365ï¼Œé—°å¹´366ã€‚" },
        { text: "Aè¯´ï¼š'å¦‚æœæˆ‘æ˜¯ç‹¼äººï¼Œæˆ‘å°±ä¸ä¼šå‘Šè¯‰ä½ 'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "è¿™æ˜¯ä¸€é“é™·é˜±é¢˜ã€‚ç‹¼äººè¯´è°ï¼Œæ‰€ä»¥ç‹¼äººä¼šè¯´'æˆ‘ä¼šå‘Šè¯‰ä½ 'å—ï¼Ÿå…¶å®è¿™æ˜¯å¥åºŸè¯ï¼Œä½†é€šå¸¸å¥½äººä¼šç›´æ¥è¯´æˆ‘æ˜¯å¥½äººã€‚æ­¤å¤„è®¾å®šï¼šç‹¼äººè¯•å›¾æ··æ·†è§†å¬ã€‚" },
        { text: "Aè¯´ï¼š'æ­£æ–¹å½¢ä¹Ÿæ˜¯çŸ©å½¢çš„ä¸€ç§'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "çœŸè¯ï¼Œæ­£æ–¹å½¢æ˜¯ç‰¹æ®Šçš„çŸ©å½¢ã€‚" },
        { text: "Aè¯´ï¼š'å£°éŸ³åœ¨çœŸç©ºä¸­ä¼ æ’­æœ€å¿«'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "å£°éŸ³ä¸èƒ½åœ¨çœŸç©ºä¸­ä¼ æ’­ã€‚Aæ˜¯ç‹¼äººã€‚" },
        { text: "Aè¯´ï¼š'æ¤ç‰©è¿›è¡Œå…‰åˆä½œç”¨éœ€è¦é˜³å…‰'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "ç§‘å­¦äº‹å®ã€‚" },
        { text: "Aè¯´ï¼š'1åƒå…‹æ£‰èŠ±æ¯”1åƒå…‹é“è½»'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "éƒ½æ˜¯1åƒå…‹ï¼Œä¸€æ ·é‡ï¼" },
        { text: "Aè¯´ï¼š'æ²¡æœ‰æ¯”æœ€å¤§çš„æ•°å­—æ›´å¤§çš„æ•°å­—äº†'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "çœŸè¯ï¼Œæ•°å­—æ˜¯æ— ç©·çš„ï¼Œæ²¡æœ‰æ‰€è°“çš„'æœ€å¤§æ•°å­—'ã€‚" },
        { text: "Aè¯´ï¼š'é»„ç“œé•¿åœ¨æ ‘ä¸Š'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "é»„ç“œæ˜¯è—¤è”“æ¤ç‰©ï¼Œé•¿åœ¨åœ°ä¸Šæˆ–æ¶å­ä¸Šã€‚" },
        { text: "Aè¯´ï¼š'åˆšæ‰ä½ åœ¨å‘¼å¸'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "å½“ç„¶ï¼Œä¸ç„¶ä½ å°±æ™•è¿‡å»äº†ã€‚" },
        { text: "Aè¯´ï¼š'å¦‚æœæ˜¨å¤©æ˜¯æ˜å¤©ï¼Œé‚£ä¹ˆä»Šå¤©å°±æ˜¯æ˜ŸæœŸäº”'ï¼ˆèƒ¡è¨€ä¹±è¯­ï¼‰ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "æ˜æ˜¾çš„é€»è¾‘æ··ä¹±ï¼Œç‹¼äººå¸¸ç”¨çš„æŠŠæˆã€‚" },
        { text: "Aè¯´ï¼š'ä»»ä½•æ•°å­—ä¹˜ä»¥0éƒ½ç­‰äº0'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "æ•°å­¦äº‹å®ã€‚" },
        { text: "Aè¯´ï¼š'ä¼é¹…ä¼šä¸‹è›‹'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "ä¼é¹…æ˜¯é¸Ÿç±»ï¼Œå½“ç„¶ä¸‹è›‹ã€‚" },
        { text: "Aè¯´ï¼š'èœ—ç‰›è·‘å¾—æ¯”çŒè±¹å¿«'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "æ˜¾è€Œæ˜“è§çš„è°è¨€ã€‚" },
        { text: "Aè¯´ï¼š'æˆ‘æ˜¯ä½ çˆ¸çˆ¸çš„å“¥å“¥çš„å„¿å­çš„å¦¹å¦¹'ã€‚<br>è¿™æ˜¯ä½ çš„ï¼Ÿ", options: ["è¡¨å¦¹/å ‚å¦¹", "ç‹¼äººèƒ¡æ‰¯"], correct: 0, explain: "çˆ¸çˆ¸çš„å“¥å“¥æ˜¯ä¼¯ä¼¯ï¼Œä¼¯ä¼¯çš„å„¿å­æ˜¯å ‚å“¥ï¼Œå ‚å“¥çš„å¦¹å¦¹æ˜¯å ‚å¦¹ã€‚é€»è¾‘é€šé¡ºï¼Œå¯èƒ½æ˜¯å¥½äººã€‚" },
        { text: "Aè¯´ï¼š'å¸çƒŸæœ‰ç›Šå¥åº·'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "æœ‰å®³å¥åº·ï¼ŒAåœ¨æ’’è°ã€‚" },
        { text: "Aè¯´ï¼š'æœ‰äº›çŒ«å–œæ¬¢æ¸¸æ³³'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 0, explain: "çœŸè¯ï¼Œæ¯”å¦‚åœŸè€³å…¶æ¢µçŒ«å°±å–œæ¬¢æ°´ã€‚" },
        { text: "Aè¯´ï¼š'æœˆäº®æœ¬èº«ä¼šå‘å…‰'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "æœˆäº®åå°„å¤ªé˜³å…‰ï¼Œè‡ªå·±ä¸å‘å…‰ã€‚" },
        { text: "Aè¯´ï¼š'ä¸‰è§’å½¢æœ‰å››æ¡è¾¹'ã€‚<br>Aæ˜¯å¥½äººè¿˜æ˜¯ç‹¼äººï¼Ÿ", options: ["å¥½äºº", "ç‹¼äºº"], correct: 1, explain: "é‚£æ˜¯å››è¾¹å½¢ã€‚" }
    ];

    // 3. æ·±åº¦é€»è¾‘/æ¨ç† (Pattern & Position)
    const masterLogicDB = [
        { text: "æ‰¾è§„å¾‹ï¼š2, 4, 8, 16, ?<br>ä¸‹ä¸€ä¸ªæ•°å­—æ˜¯ï¼Ÿ", options: ["24", "32", "18"], correct: 1, explain: "æ¯ä¸ªæ•°å­—ä¹˜ä»¥2ã€‚16 x 2 = 32ã€‚" },
        { text: "ç”²åœ¨ä¹™çš„å·¦è¾¹ï¼Œä¸™åœ¨ä¹™çš„å³è¾¹ã€‚<br>ä¸åœ¨ç”²çš„å·¦è¾¹ã€‚<br>è°åœ¨æœ€å³è¾¹ï¼Ÿ", options: ["ç”²", "ä¹™", "ä¸™", "ä¸"], correct: 2, explain: "é¡ºåºï¼šä¸ -> ç”² -> ä¹™ -> ä¸™ã€‚ä¸™åœ¨æœ€å³ã€‚" },
        { text: "ç°åœ¨æ˜¯ä¸‹åˆ3ç‚¹ã€‚90åˆ†é’Ÿå‰æ˜¯å‡ ç‚¹ï¼Ÿ", options: ["1:30", "2:30", "4:30"], correct: 0, explain: "90åˆ†é’Ÿæ˜¯1å°æ—¶30åˆ†ã€‚3:00 - 1:30 = 1:30ã€‚" },
        { text: "å¦‚æœæ˜¯â€œåå¤©â€çš„å‰ä¸€å¤©ï¼Œæ˜¯å“ªå¤©ï¼Ÿ", options: ["ä»Šå¤©", "æ˜å¤©", "æ˜¨å¤©"], correct: 1, explain: "åå¤© = ä»Šå¤©+2ã€‚åå¤©çš„å‰ä¸€å¤© = ä»Šå¤©+2-1 = æ˜å¤©ã€‚" },
        { text: "æ‰¾è§„å¾‹ï¼š1, 1, 2, 3, 5, 8, ?<br>(æ–æ³¢é‚£å¥‘æ•°åˆ—)", options: ["11", "12", "13"], correct: 2, explain: "å‰ä¸¤ä¸ªæ•°ç›¸åŠ ç­‰äºåä¸€ä¸ªæ•°ã€‚5 + 8 = 13ã€‚" },
        { text: "å°çº¢æ’é˜Ÿï¼Œå‰é¢æœ‰3äººï¼Œåé¢æœ‰4äººã€‚<br>é˜Ÿä¼ä¸€å…±æœ‰å‡ äººï¼Ÿ", options: ["7äºº", "8äºº", "9äºº"], correct: 1, explain: "3(å‰) + 1(å°çº¢) + 4(å) = 8äººã€‚" },
        { text: "ä¸€æ–¤æ£‰èŠ±å’Œä¸€æ–¤é“ï¼Œå“ªä¸ªä½“ç§¯å¤§ï¼Ÿ", options: ["æ£‰èŠ±", "é“", "ä¸€æ ·å¤§"], correct: 0, explain: "æ³¨æ„é—®çš„æ˜¯ä½“ç§¯ï¼æ£‰èŠ±å¯†åº¦å°ï¼Œä¸€æ–¤æ£‰èŠ±éå¸¸å¤§è“¬æ¾ã€‚" },
        { text: "Aæ¯”Bé«˜ï¼ŒCæ¯”AçŸ®ï¼Œä½†Cæ¯”Bé«˜ã€‚<br>è¯·æ’åºé«˜åº¦ã€‚", options: ["A>B>C", "A>C>B", "C>A>B"], correct: 1, explain: "Aæœ€é«˜ï¼ŒCåœ¨ä¸­é—´ï¼ŒBæœ€çŸ®ã€‚" },
        { text: "å¦‚æœæ˜¨å¤©æ˜¯å‘¨å…­ï¼Œé‚£ä¹ˆåå¤©æ˜¯å‘¨å‡ ï¼Ÿ", options: ["å‘¨ä¸€", "å‘¨äºŒ", "å‘¨ä¸‰"], correct: 1, explain: "æ˜¨å¤©å‘¨å…­ -> ä»Šå¤©å‘¨æ—¥ -> æ˜å¤©å‘¨ä¸€ -> åå¤©å‘¨äºŒã€‚" },
        { text: "ç›’å­é‡Œæœ‰çº¢çƒå’Œè“çƒã€‚çº¢çƒæ¯”è“çƒå¤šã€‚<br>ä»¥ä¸‹å“ªä¸ªä¸å¯èƒ½ï¼Ÿ", options: ["çº¢5è“3", "çº¢4è“4", "çº¢10è“1"], correct: 1, explain: "çº¢4è“4æ˜¯ç›¸ç­‰ï¼Œä¸ç¬¦åˆ'çº¢æ¯”è“å¤š'ã€‚" },
        { text: "æˆ‘çˆ¶äº²çš„å¦»å­çš„å¥³å„¿çš„å¼Ÿå¼Ÿæ˜¯æˆ‘çš„ï¼Ÿ", options: ["è¡¨å¼Ÿ", "å“¥å“¥æˆ–å¼Ÿå¼Ÿ", "ä¾„å­"], correct: 1, explain: "çˆ¶äº²çš„å¦»å­=å¦ˆå¦ˆï¼›å¦ˆå¦ˆçš„å¥³å„¿=å§å¦¹ï¼›å§å¦¹çš„å¼Ÿå¼Ÿ=æˆ‘çš„å…„å¼Ÿã€‚" },
        { text: "æ‰¾è§„å¾‹ï¼š100, 95, 90, 85, ? ", options: ["80", "75", "84"], correct: 0, explain: "æ¯æ¬¡å‡5ã€‚" },
        { text: "ä¸€è¾†è½¦æœ‰4ä¸ªè½®å­ï¼Œ5è¾†è½¦åŠ 1è¾†ä¸‰è½®è½¦å…±æœ‰å‡ ä¸ªè½®å­ï¼Ÿ", options: ["20", "23", "24"], correct: 1, explain: "4x5 = 20, åŠ 3 = 23ã€‚" },
        { text: "ä¹¦æ¶ä¸Šå±‚ä¹¦æ¯”ä¸‹å±‚å¤šã€‚å¦‚æœä»ä¸Šå±‚æ‹¿2æœ¬ç»™ä¸‹å±‚ï¼Œä¸¤å±‚å°±ä¸€æ ·å¤šäº†ã€‚<br>åŸæ¥ä¸Šå±‚æ¯”ä¸‹å±‚å¤šå‡ æœ¬ï¼Ÿ", options: ["2æœ¬", "4æœ¬", "6æœ¬"], correct: 1, explain: "ç»™2æœ¬æ„å‘³ç€ä¸Šå±‚-2ï¼Œä¸‹å±‚+2ã€‚å·®è·ç¼©å°äº†4æœ¬æ‰ç›¸ç­‰ï¼Œè¯´æ˜åŸæ¥å¤š4æœ¬ã€‚" },
        { text: "ä¸œå—è¥¿åŒ—å››ä¸ªæ–¹å‘ã€‚å¦‚æœä½ é¢å‘åŒ—æ–¹ï¼Œå‘åè½¬ï¼Œå†å‘å³è½¬ï¼Œä½ ç°åœ¨é¢å‘å“ªï¼Ÿ", options: ["ä¸œ", "è¥¿", "å—"], correct: 0, explain: "é¢å‘åŒ— -> å‘åè½¬(å—) -> å‘å³è½¬(ä¸œ)ã€‚" },
        { text: "Aã€Bã€Cä¸‰äººè·‘æ­¥ã€‚<br>Aæ¯”Bå¿«ï¼ŒAæ²¡æœ‰Cå¿«ã€‚<br>è°è·‘ç¬¬ä¸€ï¼Ÿ", options: ["A", "B", "C"], correct: 2, explain: "C > A > Bã€‚" },
        { text: "ç”¨3æ ¹ç«æŸ´æœ€å¤šèƒ½æ‹¼å‡ºå‡ ä¸ªä¸‰è§’å½¢ï¼Ÿ", options: ["1ä¸ª", "2ä¸ª", "0ä¸ª"], correct: 0, explain: "å¹³é¢ä¸Š1ä¸ªã€‚å¦‚æœç«‹ä½“æ€ç»´å¾ˆéš¾ï¼Œé€šå¸¸é€»è¾‘é¢˜æŒ‡å¹³é¢ã€‚" },
        { text: "å“ªä¸ªæ•°å­—å€’è¿‡æ¥çœ‹å˜å¤§äº†ï¼Ÿ", options: ["6", "8", "9"], correct: 0, explain: "6å€’è¿‡æ¥æ˜¯9ï¼Œå˜å¤§äº†ã€‚9å€’è¿‡æ¥æ˜¯6ï¼Œå˜å°äº†ã€‚" },
        { text: "æ‰¾è§„å¾‹ï¼šA, C, E, G, ?", options: ["H", "I", "J"], correct: 1, explain: "éš”ä¸€ä¸ªå­—æ¯ï¼šA(b)C(d)E(f)G(h)Iã€‚" }
    ];

    // ==========================================
    // â¬‡ï¸ æ¸¸æˆæ§åˆ¶ä¸æ´—ç‰Œé€»è¾‘
    // ==========================================

    let gameState = {
        fact: { idx: 0, list: [], finished: false },
        wolf: { idx: 0, list: [], finished: false },
        logic: { idx: 0, list: [], finished: false }
    };
    let globalScore = 0;
    let currentTab = 'fact';

    // éšæœºæ´—ç‰Œç®—æ³• (Fisher-Yates Shuffle)
    function shuffleArray(array) {
        let arr = JSON.parse(JSON.stringify(array)); // æ·±æ‹·è´é˜²æ­¢ä¿®æ”¹åŸæ•°ç»„
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }

    // åˆå§‹åŒ–æ¸¸æˆï¼šä»é¢˜åº“ä¸­æŠ½å–æŒ‡å®šæ•°é‡
    function initGame() {
        // é…ç½®ï¼šæ¯å¤©æŠ½å–å¤šå°‘é¢˜
        // ç›®æ ‡ï¼šæ€»å…± 50 é¢˜
        // Fact: 15, Wolf: 20, Logic: 15
        gameState.fact.list = shuffleArray(masterFactDB).slice(0, 15);
        gameState.wolf.list = shuffleArray(masterWolfDB).slice(0, 20);
        gameState.logic.list = shuffleArray(masterLogicDB).slice(0, 15);
        
        console.log(`Loaded: F:${gameState.fact.list.length}, W:${gameState.wolf.list.length}, L:${gameState.logic.list.length}`);
        
        globalScore = 0;
        document.getElementById('global-score').innerText = "0";
        renderQuestion();
    }

    function switchTab(tab) {
        currentTab = tab;
        
        // æ›´æ–°å¯¼èˆªæŒ‰é’®
        document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`.nav-btn[data-tab="${tab}"]`).classList.add('active');
        
        // éšè—/æ˜¾ç¤ºç•Œé¢
        document.getElementById('game-card').style.display = 'none';
        document.getElementById('done-card').style.display = 'none';
        document.getElementById('coupon-card').style.display = 'none';

        // åˆ¤æ–­æ˜¯å¦å…¨éƒ¨é€šå…³
        if (gameState.fact.finished && gameState.wolf.finished && gameState.logic.finished) {
            calculateFinalReward();
            return;
        }

        // åˆ¤æ–­å½“å‰å…³å¡æ˜¯å¦å®Œæˆ
        if (gameState[tab].finished) {
            document.getElementById('done-card').style.display = 'block';
        } else {
            document.getElementById('game-card').style.display = 'block';
            renderQuestion();
        }
    }

    function renderQuestion() {
        const state = gameState[currentTab];
        const q = state.list[state.idx];
        const total = state.list.length;

        // è¿›åº¦æ›´æ–°
        document.getElementById('progress-text').innerText = `è¿›åº¦ï¼š${state.idx + 1} / ${total}`;
        document.getElementById('progress-bar').style.width = `${((state.idx)/total)*100}%`;

        // é¢˜ç›®æ˜¾ç¤º
        document.getElementById('q-text').innerHTML = q.text;
        
        // é‡ç½®çŠ¶æ€
        document.getElementById('feedback').style.display = 'none';
        document.getElementById('next-btn').style.display = 'none';
        
        // æŒ‰é’®æ˜¾ç¤ºé€»è¾‘
        const factGroup = document.getElementById('fact-btns');
        const optGroup = document.getElementById('opt-btns');

        if (currentTab === 'fact') {
            factGroup.style.display = 'flex';
            optGroup.style.display = 'none';
            Array.from(factGroup.children).forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.style.transform = 'scale(1)';
            });
        } else {
            factGroup.style.display = 'none';
            optGroup.style.display = 'grid';
            optGroup.innerHTML = '';
            
            q.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'btn-opt';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(i, btn);
                optGroup.appendChild(btn);
            });
        }
    }

    function checkAnswer(userIndex, btnRef) {
        const state = gameState[currentTab];
        const q = state.list[state.idx];
        let isCorrect = false;

        // é€»è¾‘åˆ¤æ–­
        if (currentTab === 'fact') {
            const typeIndex = (q.type === 'fact') ? 0 : 1; // Fact button is index 0
            // ä¿®æ­£ï¼šfactä¼ å…¥çš„ userIndex æ˜¯å­—ç¬¦ä¸² 'fact' æˆ– 'opinion'
            const userType = (userIndex === 'fact') ? 'fact' : 'opinion';
            isCorrect = (userType === q.type);

            Array.from(document.getElementById('fact-btns').children).forEach(b => {
                b.disabled = true;
                b.style.opacity = '0.6';
            });
        } else {
            isCorrect = (userIndex === q.correct);
            Array.from(document.getElementById('opt-btns').children).forEach(b => {
                b.disabled = true;
                b.style.cursor = 'default';
            });
            
            if (isCorrect) {
                btnRef.style.background = '#e8f8f5';
                btnRef.style.borderColor = '#2ecc71';
            } else {
                btnRef.style.background = '#fdedec';
                btnRef.style.borderColor = '#e74c3c';
                const opts = document.getElementById('opt-btns').children;
                // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
                if(opts[q.correct]) {
                    opts[q.correct].style.background = '#e8f8f5';
                    opts[q.correct].style.borderColor = '#2ecc71';
                }
            }
        }

        // è®¡åˆ†
        if (isCorrect) {
            globalScore += 1;
            document.getElementById('global-score').innerText = globalScore;
        }

        // åé¦ˆä¿¡æ¯
        const fb = document.getElementById('feedback');
        fb.style.display = 'block';
        fb.className = isCorrect ? 'feedback-box correct' : 'feedback-box wrong';
        fb.innerHTML = `<strong>${isCorrect ? 'ğŸ‰ ç­”å¯¹äº†ï¼' : 'ğŸ˜… ç­”é”™äº†'}</strong><div class="explain-text">${q.explain}</div>`;
        
        document.getElementById('next-btn').style.display = 'block';
        document.getElementById('progress-bar').style.width = `${((state.idx + 1)/state.list.length)*100}%`;
    }

    function nextQuestion() {
        const state = gameState[currentTab];
        state.idx++;
        
        if (state.idx >= state.list.length) {
            state.finished = true;
            document.querySelector(`.nav-btn[data-tab="${currentTab}"]`).classList.add('finished');
            
            if (gameState.fact.finished && gameState.wolf.finished && gameState.logic.finished) {
                calculateFinalReward();
            } else {
                document.getElementById('game-card').style.display = 'none';
                document.getElementById('done-card').style.display = 'block';
            }
        } else {
            renderQuestion();
        }
    }

    function calculateFinalReward() {
        document.getElementById('game-card').style.display = 'none';
        document.getElementById('done-card').style.display = 'none';
        document.getElementById('coupon-card').style.display = 'block';

        const totalQ = 50;
        let finalTime = globalScore;
        let msg = "";
        let showBonus = false;

        // å¥–åŠ±è§„åˆ™ (åŸºäº50é¢˜)
        // 1. 48-50åˆ†: ç‹è€…çº§ (åŸå§‹åˆ† + 25åˆ†é’Ÿ) -> æœ€é«˜75åˆ†é’Ÿ
        // 2. 40-47åˆ†: é’»çŸ³çº§ (åŸå§‹åˆ† + 10åˆ†é’Ÿ)
        // 3. 30-39åˆ†: é»„é‡‘çº§ (åŸå§‹åˆ†)
        // 4. <30åˆ†:  å®‰æ…°å¥– (å¾—åˆ†æ‰“8æŠ˜)

        if (globalScore >= 48) {
            finalTime = globalScore + 25;
            msg = "ğŸ† æœ€å¼ºå¤§è„‘ï¼é”™è¯¯â‰¤2ï¼Œè§¦å‘è¶…çº§å¥–åŠ± (+25åˆ†é’Ÿ)ï¼";
            showBonus = true;
        } else if (globalScore >= 40) {
            finalTime = globalScore + 10;
            msg = "ğŸ˜ éå¸¸æ£’ï¼å¾—åˆ†è¶…è¿‡40ï¼Œè§¦å‘é¢å¤–å¥–åŠ± (+10åˆ†é’Ÿ)ï¼";
            showBonus = true;
        } else if (globalScore >= 30) {
            msg = "ğŸ™‚ æˆç»©åˆæ ¼ã€‚æ¯1åˆ†å…‘æ¢1åˆ†é’Ÿç”µè§†æ—¶é—´ã€‚";
        } else {
            finalTime = Math.floor(globalScore * 0.8);
            msg = "ğŸ˜… é”™è¯¯æœ‰ç‚¹å¤šå“¦ï¼Œæ—¶é—´æ‰“ä¸ªæŠ˜ï¼Œæ˜å¤©åŠ æ²¹ï¼";
        }

        document.getElementById('raw-score').innerText = globalScore;
        document.getElementById('final-minutes').innerText = finalTime;
        document.getElementById('reward-explain').innerText = msg;
        
        if (showBonus) {
            document.getElementById('bonus-msg').style.display = 'inline-block';
        }
    }

    // å¯åŠ¨æ¸¸æˆ
    initGame();

</script>

</body>
</html>
